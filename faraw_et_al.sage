from sage.crypto.sbox import SBox
f = GF(2**8, x, x^8+x^6+x^5+x^4+1, repr='int')
fi = f.from_integer
def g(t):
    if t == 47:
        return 149
    return (fi(29)*fi(t) + fi(15)) / (fi(8)*fi(t)+fi(9))
sbox = SBox([g(i) for i in range(256)])
result = list(map(int, 
"""124 18 154 77 3 216 99 81 117 91 112 125 88 32 10 96
227 253 141 194 235 5 111 9 122 37 206 233 156 72 53 51
184 7 20 239 102 22 166 210 192 97 226 27 12 248 79 149
69 59 196 220 132 109 94 168 234 84 15 108 120 52 142 14
25 90 151 205 93 0 26 171 217 41 1 67 224 197 21 198
130 174 231 161 199 153 76 6 144 170 246 221 43 232 29 219
61 229 191 242 195 95 137 225 157 75 39 119 44 98 104 87
115 89 56 110 160 42 31 249 169 222 146 11 245 238 136 247
54 139 200 8 36 46 126 218 121 165 105 16 58 35 135 164
207 230 2 243 63 123 214 80 68 55 183 114 107 208 62 163
252 145 116 250 13 204 127 228 187 113 49 86 159 83 152 244
180 193 57 173 133 128 150 30 40 190 255 240 237 155 85 175
162 47 134 50 60 28 186 177 33 202 176 19 70 209 24 178
71 38 212 48 201 172 129 143 215 188 181 147 158 65 101 100
251 179 182 203 140 223 66 254 64 23 45 189 17 213 131 4
73 211 167 74 78 148 236 185 92 241 82 103 118 106 34 138"""
.replace("\n", " ").split(" ")))
assert result == list(sbox)
assert sbox.nonlinearity() == 112